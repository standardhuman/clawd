# 2026-02-13 â€” Major Infrastructure Day

## Cost Optimization Setup (Morning)
- Analyzed Alex Finn YouTube video on model cost optimization â€” confirmed our multi-model strategy
- Configured **Gemini 2.5 Flash** as `imageModel.primary` fallback â€” screenshots now work on all text-only models (DeepSeek, Kimi). Free tier. Google API key already in config for nano-banana-pro.
- **Swapped Anthropic OAuth token for real API key** (`sk-ant-api03-...`) from console.anthropic.com. Retrieved from 1Password ("Anthropic API Credentials") via tmux+op. No more TOS ban risk. Brian needs to fund the account â€” recommended starting with $50.
- **Trimmed AGENTS.md by 76%** â€” from 13,744 bytes (~3,436 tokens) to 3,334 bytes (~833 tokens). Saves ~2,600 tokens loaded on every single message. Verbose sections moved to `docs/agent-reference.md` (prompt injection defense, version control details, group chat guidelines, heartbeat section).
- Built **dashboard sync script** (`~/clawd/dashboard/sync.sh`) â€” bash+jq, no AI, updates deadlines/progress from project files, auto-commits and pushes to Vercel. Run manually with `./sync.sh`.

## Model Menu (Final State)
- `/model opus` â€” Opus 4.6, $5/$25 MTok, native images âœ…
- `/model deepseek` â€” DeepSeek V3.2, $0.28/$0.42 MTok, images â†’ Gemini Flash âœ…
- `/model kimi` â€” Kimi K2.5 via NVIDIA, free, images â†’ Gemini Flash âœ…
- `/model deepseek-r` â€” DeepSeek Reasoner, $0.28/$0.42 MTok âœ…
- Image fallback: `google/gemini-2.5-flash-preview` (free)

## Vehicle Purchase Analysis
- Saved full analysis to Obsidian: `~/Documents/Brian's Vault/SailorSkills/Business/Vehicle Purchase Analysis.md`
- **ALSO TM-B e-bike** â€” Rivian spinoff, Class 3, 28mph, 60-100mi range, 324lb payload, modular. Brian has reservation for Performance model ($4,500). Shipping spring 2026.
- Combined analysis: Ram ($17K) + TM-B ($4,500) = $23,600 - Subaru sale ($7,500) = $16,100 net before deductions
- **Section 179 at 50% business use**: Ram GVWR 6,800-6,900 lbs (qualifies as heavy vehicle). $8,500 deductible, ~$2,661 Year 1 tax savings. Effective net: ~$13,440.
- Standard mileage ($0.70/mi Ã— 6,000 biz miles) = ~$1,315/yr ongoing savings. But can't use standard mileage if Section 179 taken in Year 1 â€” CPA should advise.
- 5-year TCO: ~$5,300 more than keeping Subaru, but you get a fully built adventure vehicle + e-bike replacing daily driving.

## Mission Control (Afternoon)
- **Built pixel-art animated office dashboard** â€” visualizes Howard, Jacques, Marcel as characters at desks
- Phase 1: Pure CSS pixel art, React+Vite+TypeScript+Tailwind, Catppuccin Mocha theme, 64KB gzipped. Built by sub-agent in 6 minutes for $0.01.
- Phase 2: Live gateway data via WebSocket, accurate per-model cost calculation, password gate, cross-links with dashboard. Built in 8 minutes for $0.02.
- **Jacques jumped in** unprompted â€” created GitHub repo (`standardhuman/mission-control`), fixed agent roles, pushed to main. Good initiative.
- **Integrated into dashboard** as tab view â€” `dashboard.briancline.co` now has ðŸ“Š Dashboard + ðŸŽ® Mission Control tabs. iframe embed with shared auth bypass.
- **Deployed to Vercel**: `mission-control.briancline.co`

## Tailscale Funnel for Live Data
- Enabled `gateway.tailscale.mode: "funnel"` â€” exposes gateway at `https://brians-mac-mini.taile67de1.ts.net/`
- Required switching auth from `token` to `password` mode (funnel requirement)
- Gateway password = `e059593f603e67d3db32f3eab1adfe649f14cb4492fc0d79` (same as old token)
- Set `controlUi.allowInsecureAuth: true` and `dangerouslyDisableDeviceAuth: true` to skip challenge-response signing for custom WebSocket client
- Set `controlUi.allowedOrigins` to include both dashboard and mission-control Vercel domains
- Fixed `useGateway` hook to handle `connect.challenge` event before sending connect request (non-local connections require challenge-response handshake)
- `.env.production` has gateway URL (`wss://brians-mac-mini.taile67de1.ts.net/`) and password baked in
- **Status: debugging** â€” deployed but Brian still saw DEMO mode. Latest fix pushed (challenge handler). Awaiting verification.

## Config Changes Made Today
- `agents.defaults.imageModel.primary` = `google/gemini-2.5-flash-preview`
- `env.GEMINI_API_KEY` added
- `env.ANTHROPIC_API_KEY` changed from OAuth (`sk-ant-oat01-...`) to real API key (`sk-ant-api03-...`)
- `tools.agentToAgent.enabled` = true (Howard can message Jacques/Marcel)
- `gateway.tailscale.mode` = `funnel`
- `gateway.auth.mode` = `password` (was `token`)
- `gateway.auth.password` added
- `gateway.controlUi.allowInsecureAuth` = true
- `gateway.controlUi.dangerouslyDisableDeviceAuth` = true
- `gateway.controlUi.allowedOrigins` = dashboard + mission-control domains

## Ajit Communication
- Brian sent Ajit a message about our multi-model setup (Brian handled this himself)
- Shared Jorge's (Ajit's Howard equivalent) model recommendations â€” Opus for main agent, Sonnet for secondary, Haiku for heartbeats
- Howard's take: Jorge's plan is good but conservative. Sonnet ($3/$15) for secondary agents when DeepSeek ($0.28/$0.42) would be 90% cheaper for routine work.

## Memory Search Issue
- `memory_search` tool returned error: "Cannot find module 'dist/manager-DtFcs1NT.js'" â€” the local embeddings module may have a version mismatch with the gateway. Works in config but tool call fails.

## Open Items
- Verify Mission Control shows LIVE (not DEMO) from public URL
- Brian needs to fund Anthropic console account (~$50 recommended)
- Send Ajit message was already handled by Brian
- Peter's truck â€” still waiting to see if friend buys it first
